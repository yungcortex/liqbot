<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Liquidation Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
        
        body {
            background-color: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #0f0;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 0 0 10px #0f0;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stats-box {
            border: 1px solid #0f0;
            padding: 20px;
            border-radius: 5px;
            background-color: rgba(0, 255, 0, 0.1);
        }

        .stats-box h2 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #0f0;
            text-align: center;
        }

        .stats-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .stats-label {
            color: #0f0;
        }

        .stats-value {
            color: #fff;
        }

        #recent-liquidations {
            border: 1px solid #0f0;
            padding: 20px;
            border-radius: 5px;
            background-color: rgba(0, 255, 0, 0.1);
            height: 300px;
            overflow-y: auto;
        }

        .liquidation-entry {
            margin-bottom: 10px;
            padding: 5px;
            border-bottom: 1px solid rgba(0, 255, 0, 0.3);
        }

        #status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 5px 10px;
            border-radius: 3px;
        }

        #status.connected {
            background-color: #0f0;
            color: #000;
        }

        #status.disconnected {
            background-color: #f00;
            color: #fff;
        }

        .glitch-animation {
            animation: glitch 0.2s ease-in-out;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }
    </style>
</head>
<body class="p-8">
    <div class="container mx-auto">
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-center">Crypto Liquidation Tracker</h1>
            <div class="crypto-card rounded-lg px-4 py-2">
                <span>Status: </span>
                <span id="connection-status" class="font-bold">Connecting...</span>
            </div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Bitcoin Card -->
            <div class="crypto-card rounded-lg p-6">
                <div class="flex items-center mb-4">
                    <span class="crypto-icon">â‚¿</span>
                    <h2 class="text-xl">Bitcoin</h2>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p>Long Liqs</p>
                        <p class="value" id="btc-longs">0</p>
                    </div>
                    <div>
                        <p>Short Liqs</p>
                        <p class="value" id="btc-shorts">0</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p>Total Value</p>
                    <p class="value" id="btc-total">$0.00</p>
                </div>
            </div>

            <!-- Ethereum Card -->
            <div class="crypto-card rounded-lg p-6">
                <div class="flex items-center mb-4">
                    <span class="crypto-icon">Îž</span>
                    <h2 class="text-xl">Ethereum</h2>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p>Long Liqs</p>
                        <p class="value" id="eth-longs">0</p>
                    </div>
                    <div>
                        <p>Short Liqs</p>
                        <p class="value" id="eth-shorts">0</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p>Total Value</p>
                    <p class="value" id="eth-total">$0.00</p>
                </div>
            </div>

            <!-- Solana Card -->
            <div class="crypto-card rounded-lg p-6">
                <div class="flex items-center mb-4">
                    <span class="crypto-icon">â—Ž</span>
                    <h2 class="text-xl">Solana</h2>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p>Long Liqs</p>
                        <p class="value" id="sol-longs">0</p>
                    </div>
                    <div>
                        <p>Short Liqs</p>
                        <p class="value" id="sol-shorts">0</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p>Total Value</p>
                    <p class="value" id="sol-total">$0.00</p>
                </div>
            </div>
        </div>

        <div class="crypto-card rounded-lg p-6">
            <h2 class="text-xl mb-4">Recent Liquidations</h2>
            <div class="liquidation-feed" id="liquidation-feed"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Socket.IO connection
            const socket = io({
                transports: ['polling'],
                reconnection: true,
                reconnectionAttempts: 5,
                reconnectionDelay: 1000,
                reconnectionDelayMax: 5000,
                timeout: 20000,
                forceNew: true,
                closeOnBeforeunload: true
            });

            // Connection status elements
            const statusElement = document.getElementById('connection-status');
            const recentLiquidations = document.getElementById('liquidation-feed');

            // Stats elements
            const stats = {
                bitcoin: {
                    longLiqs: document.querySelector('#btc-longs'),
                    shortLiqs: document.querySelector('#btc-shorts'),
                    totalValue: document.querySelector('#btc-total')
                },
                ethereum: {
                    longLiqs: document.querySelector('#eth-longs'),
                    shortLiqs: document.querySelector('#eth-shorts'),
                    totalValue: document.querySelector('#eth-total')
                },
                solana: {
                    longLiqs: document.querySelector('#sol-longs'),
                    shortLiqs: document.querySelector('#sol-shorts'),
                    totalValue: document.querySelector('#sol-total')
                }
            };

            // Update UI function
            function updateStats(data) {
                for (const [coin, values] of Object.entries(data)) {
                    if (stats[coin]) {
                        stats[coin].longLiqs.textContent = values.long_liqs;
                        stats[coin].shortLiqs.textContent = values.short_liqs;
                        stats[coin].totalValue.textContent = `$${values.total_value.toLocaleString()}`;
                    }
                }
            }

            // Add liquidation to recent list
            function addLiquidation(data) {
                const entry = document.createElement('div');
                entry.className = 'terminal-line glitch-animation';
                const side = data.side === 'LONG' ? 'ðŸ”´ LONG LIQ' : 'ðŸŸ¢ SHORT LIQ';
                const exchange = data.exchange ? `[${data.exchange}]` : '';
                entry.innerHTML = `${new Date().toLocaleTimeString()} ${exchange} ${data.symbol} ${side} ${data.amount.toFixed(3)} @ $${data.price.toFixed(2)} = $${data.value.toFixed(2)}`;
                recentLiquidations.insertBefore(entry, recentLiquidations.firstChild);
                
                // Keep only last 100 entries
                const maxLines = 100;
                const lines = recentLiquidations.getElementsByClassName('terminal-line');
                if (lines.length > maxLines) {
                    for (let i = maxLines; i < lines.length; i++) {
                        lines[i].remove();
                    }
                }
            }

            // Socket event handlers
            socket.on('connect', () => {
                statusElement.textContent = 'Connected';
                statusElement.className = 'connected';
                console.log('Connected to server');
            });

            socket.on('disconnect', () => {
                statusElement.textContent = 'Disconnected';
                statusElement.className = 'disconnected';
                console.log('Disconnected from server');
            });

            socket.on('initial_data', (data) => {
                console.log('Received initial data:', data);
                updateStats(data);
            });

            socket.on('stats_update', (data) => {
                console.log('Received stats update:', data);
                updateStats(data);
            });

            socket.on('liquidation', (data) => {
                console.log('Received liquidation:', data);
                addLiquidation(data);
            });

            // Heartbeat
            setInterval(() => {
                if (socket.connected) {
                    socket.emit('heartbeat');
                }
            }, 10000);
        });
    </script>
</body>
</html> 